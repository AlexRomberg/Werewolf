import{a as R,j as J}from"./chunk-MBABEOSW.js";import{Aa as r,Ea as X,Ja as b,Jb as B,Na as N,Oa as g,V as H,Xa as s,Ya as y,Za as w,_a as T,aa as u,ab as P,ba as _,bb as z,ca as h,cb as $,da as A,db as O,eb as l,fb as d,gb as C,hb as M,ja as E,kb as Q,ma as f,na as j,nb as x,oa as L,ob as c,rb as Y,sb as q,tb as W,ub as V,vb as F}from"./chunk-S6VIYWOS.js";var G=class{GetIndexCoordinate(a,e){let n=2*Math.PI/e*a;return this.GetCoordinateByAngle(n);}GetCoordinateByAngle(a){return{x:1e3+Math.sin(a)*700,y:1e3-Math.cos(a)*700};}computeEndpoints(a,e,n,t,i){let p=this.GetIndexCoordinate(a,n),m=this.GetIndexCoordinate(e,n),v=m.x-p.x,S=m.y-p.y,D=Math.sqrt(v*v+S*S),I=v/D,k=S/D;return p.x=p.x+t*I+i*k,p.y=p.y+t*k-i*I,m.x=m.x-t*I+i*k,m.y=m.y-t*k-i*I,{origin:p,destination:m};}GetPathDescription(a,e,n,t,i=150){if(a<e){let v=a;a=e,e=v;}let{destination:p,origin:m}=this.computeEndpoints(a,e,n,i,t);return`M${m.x},${m.y}L${p.x},${p.y}`;}};function ee(o,a){if(o&1&&(h(),C(0,"path",6)),o&2){let e=a.$implicit,n=a.$index,t=c();w("stroke",t.GetConnectionColor(e.ConnectionType)),s("d",t.GetConnectionPath(n));}}function te(o,a){if(o&1){let e=M();h(),l(0,"clipPath",13),x("click",function(){u(e);let t=c().$implicit,i=c();return _(i.OnPersonClicked(t));}),l(1,"circle",14),x("click",function(){u(e);let t=c().$implicit,i=c();return _(i.OnPersonClicked(t));}),d()(),l(2,"g"),C(3,"image",15),d();}if(o&2){let e=c(),n=e.$implicit,t=e.$index,i=c();y("id","clip_"+n.Id),r(),s("cx",i.GetCoordinate(t).x)("cy",i.GetCoordinate(t).y),r(),s("clip-path","url(#clip_"+n.Id+")"),r(),s("href","img/"+n.Character.Id+".png")("x",i.GetCoordinate(t).x-110)("y",i.GetCoordinate(t).y-110);}}function ne(o,a){if(o&1&&(h(),C(0,"path",12)),o&2){let e=c().$index,n=c();s("d",n.GetCrossPath(e));}}function ie(o,a){if(o&1){let e=M();g(0,te,4,7),h(),l(1,"text",7),V(2),d(),l(3,"circle",8),x("click",function(){let t=u(e).$implicit,i=c();return _(i.OnPersonClicked(t));}),d(),C(4,"circle",9)(5,"circle",10)(6,"circle",11),g(7,ne,1,1,":svg:path",12);}if(o&2){let e=a.$implicit,n=a.$index,t=c();P(e.Character?0:-1),r(),s("x",t.GetTextCoordinate(n).x)("y",t.GetTextCoordinate(n).y),r(),F(e.Name),r(),w("stroke",t.GetRingColor(e,0)),T("!fill-zinc-700",!e.Character),s("cx",t.GetCoordinate(n).x)("cy",t.GetCoordinate(n).y),r(),w("stroke",t.GetRingColor(e,1)),s("cx",t.GetCoordinate(n).x)("cy",t.GetCoordinate(n).y),r(),w("stroke",t.GetRingColor(e,2)),s("cx",t.GetCoordinate(n).x)("cy",t.GetCoordinate(n).y),r(),w("stroke",t.GetRingColor(e,3)),s("cx",t.GetCoordinate(n).x)("cy",t.GetCoordinate(n).y),r(),P(e.IsDead?7:-1);}}var U=(()=>{class o extends G{constructor(){super(...arguments),this.gameState=H(J),this.Connections=f([]),this.People=f([]),this.PersonClick=new E();}OnPersonClicked(e){this.PersonClick.emit(e);}GetCoordinate(e){return this.GetIndexCoordinate(e,this.People().length);}GetConnectionColor(e){switch(e){case R.Love:return"red";case R.Sleepover:return"blue";case R.Trust:return"orange";default:return"black";}}GetRingColor(e,n){return[e.IsProtected&&"orange",e.IsWerewolf&&"black",e.IsEnchanted&&"deepPink",e.IsVictim&&"red"].filter(Boolean)[n]??(n==0?"#6d6e7e":"transparent");}GetConnectionPath(e){let n=this.Connections().find(m=>m.ConnectionType===e);if(!n)return"";let t=this.gameState.People.findIndex(m=>m.Id===n.From.Id),i=this.gameState.People.findIndex(m=>m.Id===n.To.Id),p=this.getConnectionOffset(n,e)*40;return this.GetPathDescription(t,i,this.People().length,p);}GetTextCoordinate(e){let n=this.GetIndexCoordinate(e,this.People().length);return{x:n.x+150-Math.abs(this.textShiftModifyer(n.y))*160,y:n.y+20+this.textShiftModifyer(n.y)*140};}GetCrossPath(e){let n=this.GetIndexCoordinate(e,this.People().length).x,t=this.GetIndexCoordinate(e,this.People().length).y,i=80;return`M${n-i},${t-i}L${n+i},${t+i}M${n-i},${t+i}L${n+i},${t-i}`;}textShiftModifyer(e){return e<400?-1:e>1600?1:0;}getConnectionOffset(e,n){let t=new Map();for(let i of this.Connections())(i.From.Id===e.From.Id&&i.To.Id===e.To.Id||i.From.Id===e.To.Id&&i.To.Id===e.From.Id)&&t.set(i.ConnectionType,t.size);return t.get(n)-(t.size-1)/2;}static{this.ɵfac=(()=>{let e;return function(t){return(e||(e=A(o)))(t||o);};})();}static{this.ɵcmp=b({type:o,selectors:[["app-people-circle"]],inputs:{Connections:[1,"Connections"],People:[1,"People"]},outputs:{PersonClick:"PersonClick"},features:[N],decls:11,vars:0,consts:[["viewBox","0 0 2000 2000","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink",0,"xml","space","preserve",0,"xmlns","serif","http://www.serif.com/",1,"max-w-svw","max-h-dvh","mx-auto",2,"fill-rule","evenodd","clip-rule","evenodd","stroke-linecap","round","stroke-linejoin","round","stroke-miterlimit","1.5"],["x","-0.125","y","-0.125","width","1.25","height","1.25","id","solid"],["flood-color","oklch(.21 .006 285.885)","result","bg"],["in","bg"],["in","SourceGraphic"],[2,"fill","none","stroke-width","22.22px",3,"stroke"],[2,"fill","none","stroke-width","22.22px"],["filter","url(#solid)",1,"fill-zinc-300"],["r","100",1,"ring","cursor-pointer",3,"click"],["r","115",1,"ring","pointer-events-none"],["r","130",1,"ring","pointer-events-none"],["r","145",1,"ring","pointer-events-none"],[1,"fill-none","stroke-red-800","pointer-events-none",2,"stroke-width","22.22px"],[1,"pointer-events-none",3,"click","id"],["r","100",1,"pointer-events-none",3,"click"],["width","220","height","220"]],template:function(n,t){n&1&&(h(),l(0,"svg",0)(1,"defs")(2,"filter",1),C(3,"feFlood",2),l(4,"feMerge"),C(5,"feMergeNode",3)(6,"feMergeNode",4),d()()(),$(7,ee,1,3,":svg:path",5,z),$(9,ie,8,23,null,null,z),d()),n&2&&(r(7),O(t.Connections()),r(2),O(t.People()));},styles:[`[_nghost-%COMP%]{grid-column-start:1;grid-row-start:1}.ring[_ngcontent-%COMP%]{fill:color-mix(in srgb,#fff 0%,transparent);stroke-width:10px}@supports (color: color-mix(in lab,red,red)){.ring[_ngcontent-%COMP%]{fill:color-mix(in oklab,var(--color-white, #fff) 0%,transparent)}}text[_ngcontent-%COMP%]{font-family:ArialMT,Arial,sans-serif;font-size:66.667px}

`]});}}return o;})();var oe=["svg"],re=(o,a)=>a.Id;function ae(o,a){if(o&1&&(h(),l(0,"clipPath",15),C(1,"circle",16),d(),l(2,"g"),C(3,"image",17),d()),o&2){let e=c(),n=e.$implicit,t=e.$index,i=c();y("id","clip_"+n.Id),r(),s("cx",i.GetEditModeCoordinate(t).x)("cy",i.GetEditModeCoordinate(t).y),r(),s("clip-path","url(#clip_"+n.Id+")"),r(),s("href","img/"+n.Character.Id+".png")("x",i.GetEditModeCoordinate(t).x-110)("y",i.GetEditModeCoordinate(t).y-110);}}function se(o,a){if(o&1){let e=M();h(),l(0,"g",12),x("pointerdown",function(t){let i=u(e).$implicit,p=c();return _(p.grab(i.Id,t));}),g(1,ae,4,7),l(2,"text",13),V(3),d(),C(4,"circle",14),d();}if(o&2){let e=a.$implicit,n=a.$index,t=c();w("animation-delay",-n/7+"s"),r(),P(e.Character!=null&&e.Character.Id?1:-1),r(),s("x",t.GetEditModeCoordinate(n).x+150)("y",t.GetEditModeCoordinate(n).y+20),r(),F(e.Name),r(),T("!fill-zinc-700",!(e.Character!=null&&e.Character.Id)),s("cx",t.GetEditModeCoordinate(n).x)("cy",t.GetEditModeCoordinate(n).y);}}function le(o,a){if(o&1&&(h(),l(0,"clipPath",15),C(1,"circle",16),d(),l(2,"g"),C(3,"image",17),d()),o&2){let e=c(2);y("id","clip_"+e.grabbedPerson().Id),r(),s("cx",e.movementPosition().x)("cy",e.movementPosition().y),r(),s("clip-path","url(#clip_"+e.grabbedPerson().Id+")"),r(),s("href","img/"+e.grabbedPerson().Character.Id+".png")("x",e.movementPosition().x-110)("y",e.movementPosition().y-110);}}function ce(o,a){if(o&1&&(h(),l(0,"g",11),g(1,le,4,7),l(2,"text",13),V(3),d(),C(4,"circle",14),d()),o&2){let e,n,t=c();r(),P(!((e=t.grabbedPerson())==null||e.Character==null)&&e.Character.Id?1:-1),r(),s("x",t.movementPosition().x+150)("y",t.movementPosition().y+20),r(),F(t.grabbedPerson().Name),r(),T("!fill-zinc-700",!((n=t.grabbedPerson().Character)!=null&&n.Id)),s("cx",t.movementPosition().x)("cy",t.movementPosition().y);}}var Z=(()=>{class o extends G{constructor(){super(...arguments),this.People=f([]),this.StaticPeople=B(()=>this.People().filter(e=>e!==this.grabbedPerson())),this.grabbedPerson=L(void 0),this.movementPosition=L({x:1e3,y:1e3}),this.movementIndex=B(()=>this.getIndexByCoordinate(this.movementPosition())),this.PeopleChange=new E();}ngOnInit(){document.addEventListener("touchmove",e=>this.handleMove(e),{passive:!1});}IsSelected(e){return this.grabbedPerson()===this.People()[e];}GetEditModeCoordinate(e){let n=e;return this.grabbedPerson()&&(e===this.movementIndex()?n+=.2:(e+1)%this.StaticPeople().length===this.movementIndex()&&(n-=.2)),this.GetIndexCoordinate(n,this.StaticPeople().length);}grab(e,n){n.preventDefault(),n.stopPropagation(),this.grabbedPerson.set(this.People().find(i=>i.Id===e));let t=this.getPositionFromEvent(n);this.movementPosition.set(this.translateCoordinate(t.x,t.y));}drop(e){if(this.grabbedPerson()!==void 0){e.stopPropagation(),e.preventDefault();let n=this.StaticPeople();n.splice(this.movementIndex()%this.StaticPeople().length,0,this.grabbedPerson()),this.PeopleChange.emit(n);}this.grabbedPerson.set(void 0);}handleMove(e){if(this.grabbedPerson()!==void 0){e.stopPropagation(),e.preventDefault();let n=this.getPositionFromEvent(e);this.movementPosition.set(this.translateCoordinate(n.x,n.y));}}translateCoordinate(e,n){let t=this.svgElement?.nativeElement.getBoundingClientRect();return t?{x:(e-t.x)/t.width*2e3,y:(n-t.y)/t.height*2e3}:{x:0,y:0};}getPositionFromEvent(e){let n="touches"in e?e.touches[0]:e;return{x:n.clientX,y:n.clientY};}getIndexByCoordinate(e){let n=Math.PI*2/this.StaticPeople().length,t=(Math.atan2(e.y-1e3,e.x-1e3)+2.5*Math.PI)%(2*Math.PI);return Math.ceil(t/n)%this.StaticPeople().length;}GetMovementHintPath(){return this.GetPathDescription(0,Math.floor(this.People().length/2),this.People().length,0,300);}GetMovementHintArrowPaths(){return[this.GetArrowPathDescription(0,Math.floor(this.People().length/2)),this.GetArrowPathDescription(Math.floor(this.People().length/2),0)];}GetArrowPathDescription(e,n){let{destination:t,origin:i}=this.computeEndpoints(e,n,this.People().length,300,0),p=Math.atan2(t.y-i.y,t.x-i.x),m=p+Math.PI/4,v=p-Math.PI/4,S=t.x-50*Math.cos(m),D=t.y-50*Math.sin(m),I=t.x-50*Math.cos(v),k=t.y-50*Math.sin(v);return`M${t.x},${t.y}L${S},${D}M${t.x},${t.y}L${I},${k}`;}static{this.ɵfac=(()=>{let e;return function(t){return(e||(e=A(o)))(t||o);};})();}static{this.ɵcmp=b({type:o,selectors:[["app-edit-circle"]],viewQuery:function(n,t){if(n&1&&Y(oe,5),n&2){let i;q(i=W())&&(t.svgElement=i.first);}},hostBindings:function(n,t){n&1&&x("pointerup",function(p){return t.drop(p);})("pointercancel",function(p){return t.drop(p);})("pointermove",function(p){return t.handleMove(p);});},inputs:{People:[1,"People"]},outputs:{PeopleChange:"PeopleChange"},features:[N],decls:16,vars:4,consts:()=>{let e;return e="Verschiebe die Personen",[["svg",""],e,["viewBox","0 0 2000 2000","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink",0,"xml","space","preserve",0,"xmlns","serif","http://www.serif.com/",1,"max-w-svw","max-h-dvh","mx-auto",2,"fill-rule","evenodd","clip-rule","evenodd","stroke-linecap","round","stroke-linejoin","round","stroke-miterlimit","1.5"],["x","-0.125","y","-0.125","width","1.25","height","1.25","id","solid"],["flood-color","oklch(.21 .006 285.885)","result","bg"],["in","bg"],["in","SourceGraphic"],[1,"fill-none","stroke-zinc-500","stroke-[18px]"],[1,"fill-none","stroke-zinc-500","stroke-[18px]",2,"stroke-dasharray","32,48,0,0,0,0"],["filter","url(#solid)","x","600","y","1000","textLength","800",1,"fill-zinc-500","text-center","italic"],[1,"shake","animate",3,"animationDelay"],[1,"z-50"],[1,"shake","animate",3,"pointerdown"],["filter","url(#solid)",1,"fill-zinc-300"],["r","100",1,"ring","cursor-pointer","fill-transparent"],[1,"pointer-events-none",3,"id"],["r","100",1,"pointer-events-none"],["width","220","height","220"]];},template:function(n,t){n&1&&(h(),l(0,"svg",2,0)(2,"defs")(3,"filter",3),C(4,"feFlood",4),l(5,"feMerge"),C(6,"feMergeNode",5)(7,"feMergeNode",6),d()()(),C(8,"path",7)(9,"path",7)(10,"path",8),l(11,"text",9),Q(12,1),d(),$(13,se,5,10,":svg:g",10,re),g(15,ce,5,8,":svg:g",11),d()),n&2&&(r(8),s("d",t.GetMovementHintArrowPaths()[0]),r(),s("d",t.GetMovementHintArrowPaths()[1]),r(),s("d",t.GetMovementHintPath()),r(3),O(t.StaticPeople()),r(2),P(t.grabbedPerson()?15:-1));},styles:[`[_nghost-%COMP%]{grid-column-start:1;grid-row-start:1}text[_ngcontent-%COMP%]{font-family:ArialMT,Arial,sans-serif;font-size:66.667px}.animate[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%], .animate[_ngcontent-%COMP%]   text[_ngcontent-%COMP%], .animate[_ngcontent-%COMP%]   image[_ngcontent-%COMP%]{transition:all .3s}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shaking infinite 1.5s linear}@keyframes _ngcontent-%COMP%_shaking{0%{transform:translate(-5px,3px)}5%{transform:translate(-4px,-3px)}10%{transform:translate(-4px,3px)}15%{transform:translate(0)}20%{transform:translate(-2px,-2px)}25%{transform:translateY(-1px)}30%{transform:translate(1px,3px)}35%{transform:translate(-3px,1px)}40%{transform:translate(2px,-4px)}45%{transform:translate(2px,-4px)}50%{transform:translate(3px,4px)}55%{transform:translate(4px)}60%{transform:translate(-3px)}65%{transform:translate(4px,4px)}70%{transform:translate(3px,-4px)}75%{transform:translate(-3px,-1px)}80%{transform:translate(-3px,1px)}85%{transform:translate(-1px,-3px)}90%{transform:translate(2px,-1px)}95%{transform:translate(-3px,2px)}to{transform:translate(-5px,3px)}}

`]});}}return o;})();function pe(o,a){if(o&1){let e=M();l(0,"app-edit-circle",4),x("PeopleChange",function(t){u(e);let i=c();return _(i.onPeopleChanged(t));}),d();}if(o&2){let e=c();y("People",e.People());}}function de(o,a){if(o&1){let e=M();l(0,"app-people-circle",5),x("PersonClick",function(t){u(e);let i=c();return _(i.onPersonClicked(t));}),d();}if(o&2){let e=c();y("People",e.People())("Connections",e.Connections());}}var $e=(()=>{class o{constructor(e){this.host=e,this.Connections=f([]),this.People=f([]),this.IsEditMode=f(!1),this.PersonClick=new E(),this.PeopleChange=new E();}onPersonClicked(e){this.PersonClick.emit(e);}onPeopleChanged(e){this.PeopleChange.emit(e);}static{this.ɵfac=function(n){return new(n||o)(X(j));};}static{this.ɵcmp=b({type:o,selectors:[["app-circle"]],inputs:{Connections:[1,"Connections"],People:[1,"People"],IsEditMode:[1,"IsEditMode"]},outputs:{PersonClick:"PersonClick",PeopleChange:"PeopleChange"},decls:4,vars:1,consts:[["viewBox","0 0 2000 2000","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink",0,"xml","space","preserve",0,"xmlns","serif","http://www.serif.com/",1,"max-w-svw","max-h-dvh","mx-auto","col-start-1","row-start-1",2,"fill-rule","evenodd","clip-rule","evenodd","stroke-linecap","round","stroke-linejoin","round","stroke-miterlimit","1.5"],["cx","1000","cy","1000","r","700",2,"fill","none","stroke","rgb(141,141,141)","stroke-width","5.28px","stroke-dasharray","26.39,26.39,0,0,0,0"],[3,"People"],[3,"People","Connections"],[3,"PeopleChange","People"],[3,"PersonClick","People","Connections"]],template:function(n,t){n&1&&(h(),l(0,"svg",0),C(1,"circle",1),d(),g(2,pe,1,1,"app-edit-circle",2)(3,de,1,2,"app-people-circle",3)),n&2&&(r(2),P(t.IsEditMode()?2:3));},dependencies:[U,Z],styles:[`[_nghost-%COMP%]{display:grid}

`]});}}return o;})();export{$e as a};/**i18n:4d237bd4a7924989e9147be91c316aeb32cdd902c29b123d66e18fd31eb96ec1*/